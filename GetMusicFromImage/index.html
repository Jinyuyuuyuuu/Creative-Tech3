<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image and Music Mapping Example</title>
    <style>
        #imageResults img, #musicData img {
            max-width: 100%;
            height: auto;
            display: block;
        }
        #musicData {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <input type="text" id="searchQuery" placeholder="Enter search term, e.g., beach">
    <button id="searchTrigger">Search</button>
    <div id="imageResults"></div>
    <div id="musicData"></div>

    <script>
        const moodMapping = {
            beach: "Relaxed",
            sunset: "Romantic",
            dog: "Joyful",
            city: "Energetic",
            nature: "Peaceful",
            flower: "Happy",
            snow: "Calm"
        };

        const moodToArtistMapping = {
            Relaxed: "Jack Johnson",
            Romantic: "Ed Sheeran",
            Joyful: "Pharrell Williams",
            Energetic: "Calvin Harris",
            Peaceful: "Norah Jones",
            Happy: "Katy Perry",
            Calm: "Adele"
        };

        const pixabayAPIKey = '42046065-e2d158f6c3dad3c7fd7a52e59';
        document.getElementById('searchTrigger').addEventListener('click', function() {
            const searchTerm = document.getElementById('searchQuery').value.trim();
            if (!searchTerm) {
                alert("Please enter a search term.");
                return;
            }
            fetchPixabayImage(searchTerm);
        });

        function fetchPixabayImage(searchTerm) {
            const url = `https://pixabay.com/api/?key=${pixabayAPIKey}&q=${encodeURIComponent(searchTerm)}&image_type=photo`;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    displayImage(data.hits[0] || null);
                })
                .catch(error => console.error('Error fetching image:', error));
        }

        function displayImage(imageData) {
            const imageSection = document.getElementById('imageResults');
            imageSection.innerHTML = imageData ? `<img src="${imageData.webformatURL}" alt="${imageData.tags}">` : '<p>No results found. Try a different search term.</p>';
            if (imageData) findMusicByMood(imageData.tags.split(', '));
        }

        function findMusicByMood(tags) {
            const artist = tags.map(tag => moodMapping[tag.toLowerCase()]).map(mood => moodToArtistMapping[mood]).find(artist => artist);
            if (artist) fetchAlbumCover(artist);
            else document.getElementById('musicData').innerHTML = '<p>No matching mood found for the image tags.</p>';
        }

        function fetchAlbumCover(artistName) {
            const apiKey = '2'; // Placeholder API key
            const url = `https://www.theaudiodb.com/api/v1/json/${apiKey}/searchalbum.php?s=${encodeURIComponent(artistName)}`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    displayAlbumCover(data.album ? data.album[0] : null);
                })
                .catch(error => console.error('Error fetching album data:', error));
        }

        function displayAlbumCover(album) {
            const musicDataSection = document.getElementById('musicData');
            musicDataSection.innerHTML = album ? `
                <h3>${album.strAlbum}</h3>
                <img src="${album.strAlbumThumb}" alt="Cover of ${album.strAlbum}">
                <p>By ${album.strArtist}</p>` : '<p>No albums found for the artist.</p>';
        }
    </script>
</body>
</html>
