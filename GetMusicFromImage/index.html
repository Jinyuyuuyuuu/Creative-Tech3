<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image and Music Mapping Example</title>
</head>
<body>
    <input type="text" id="searchQuery" placeholder="Enter search term, e.g., beach">
    <button id="searchTrigger">Search</button>
    <div id="imageResults"></div>
    <div id="musicData"></div>

    <script>
        const moodMapping = {
            beach: ["Relaxed", "Carefree"],
            sunset: ["Romantic", "Melancholic"],
            dog: ["Joyful", "Energetic"],
            city: ["Energetic", "Hustle"],
            nature: ["Peaceful", "Soothing"],
            flower: ["Happy", "Bright"],
            snow: ["Calm", "Reflective"]
        };

        const pixabayAPIKey = '42046065-e2d158f6c3dad3c7fd7a52e59'; // Replace with your actual Pixabay API key
        const searchTrigger = document.getElementById('searchTrigger');
        const searchQuery = document.getElementById('searchQuery');

        searchTrigger.addEventListener('click', function() {
            const searchTerm = searchQuery.value.trim();
            if (!searchTerm) {
                alert("Please enter a search term.");
                return;
            }
            fetchPixabayImage(searchTerm);
        });

        function fetchPixabayImage(searchTerm) {
            const url = `https://pixabay.com/api/?key=${pixabayAPIKey}&q=${encodeURIComponent(searchTerm)}&image_type=photo`;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.hits && data.hits.length > 0) {
                        const firstImage = data.hits[0];
                        displayImage(firstImage);
                        findMusicByMood(firstImage.tags);
                    } else {
                        console.log('No images found.');
                    }
                })
                .catch(error => console.error('Error fetching image:', error));
        }

        function displayImage(imageData) {
            const imageSection = document.getElementById('imageResults');
            imageSection.innerHTML = `<img src="${imageData.webformatURL}" alt="Image related to ${imageData.tags}" style="max-width: 100%; height: auto; display: block;">`;
        }

        function findMusicByMood(tags) {
            console.log("Received tags:", tags);
            const moods = [];
            const tagList = tags.split(', ').map(tag => tag.trim().toLowerCase());

            tagList.forEach(tag => {
                if (moodMapping[tag]) {
                    moods.push(...moodMapping[tag]);
                }
            });

            if (moods.length > 0) {
                displayMoodMatches(moods);
            } else {
                console.log('No matching moods found for the tags.');
                document.getElementById('musicData').innerHTML = '<p>No matching moods found for the image tags.</p>';
            }
        }

        function displayMoodMatches(moods) {
            const musicDataSection = document.getElementById('musicData');
            musicDataSection.innerHTML = `<p>Matched Music Moods: ${moods.join(', ')}</p>`;
            // Additional functionality to fetch music data based on moods could be implemented here
        }
    </script>
</body>
</html>
